<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2015-02-17T14:42:36.342765+02:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>credentials</xqdoc:name><xqdoc:comment><xqdoc:description> <p>This module provides functionality for storing credentials
 using an AES-encrypted file the project configuration folder.</p>
 <p>Specifically, the credentials will be stored in the <tt>credentials</tt>
 file in the <tt>config</tt> folder in the project root folder.
 The credentials file is encrypted using 256bit AES encryption. The AES
 key is computed using the project seed. If the project seed is changed the
 credential store is re-encrypted transparently.</p>
 <p>Each credential has an associated name and category.
 Credentials can be retrieved specifying their name and category.</p>
 <p>For each category, it is possible to specify the default credentials.
 A category default credentials can then be easily retrieved. </p>
 <p>The name of credentials and categories can contain lowercase or
 uppercase letters, digits, and the following special characters: "_" , "-",
 ".". Additionally it must not be empty and must start with a lowercase
 or uppercase letter.</p>
</xqdoc:description><xqdoc:author>Federico Cavalieri</xqdoc:author><xqdoc:custom tag="language">jsoniq</xqdoc:custom><xqdoc:custom tag="version">1.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="an" uri="http://zorba.io/annotations" isSchema="false"/><xqdoc:namespace prefix="credentials" uri="http://www.28msec.com/modules/credentials" isSchema="false"/><xqdoc:namespace prefix="err" uri="http://www.w3.org/2005/xqt-errors" isSchema="false"/><xqdoc:namespace prefix="jerr" uri="http://jsoniq.org/errors" isSchema="false"/><xqdoc:namespace prefix="mongo" uri="http://www.28msec.com/modules/mongodb" isSchema="false"/><xqdoc:namespace prefix="ver" uri="http://zorba.io/options/versioning" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>http://www.28msec.com/modules/mongodb</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables><xqdoc:variable><xqdoc:uri>credentials:mongodb-category</xqdoc:uri><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable><xqdoc:variable><xqdoc:uri>credentials:mongodb-default-credentials</xqdoc:uri><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable></xqdoc:variables><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Adds the given credentials to the credential store.
 The credentials are not set as default.</p>
 <p>If credentials  with the given name and category are already present an
 error is raised.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:add-credentials("S3", "DataBucket", { ... });
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:param>$credentials An object containing the credentials data.</xqdoc:param><xqdoc:return>the credential object</xqdoc:return><xqdoc:error>credentials:EXIST if credentials with the given name and category are already present.</xqdoc:error><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the specified credentials and category name correspond with the default MongoDB credentials</xqdoc:error><xqdoc:error>credentials:TEST if a connection cannot be established using the specified credentials</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:add-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function credentials:add-credentials($category as string, $name as string, $credentials as object()) as object()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>object()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="4"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>add-credentials</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="4"><xqdoc:comment><xqdoc:description> <p>Adds the given credentials to the credential store,
 either as default or not.</p>
 <p>If credentials  with the given name and category are already present an
 error is raised.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:add-credentials("S3", "DataBucket", { ... }, true);
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:param>$credentials An object containing the credentials data.</xqdoc:param><xqdoc:param>$default Whether the credentials will be default or not.</xqdoc:param><xqdoc:return>the credential object</xqdoc:return><xqdoc:error>credentials:EXIST if credentials with the given name and category are already present.</xqdoc:error><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if trying to add the default MongoDB credentials</xqdoc:error><xqdoc:error>credentials:TEST if a connection cannot be established using the specified credentials</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:add-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function credentials:add-credentials($category as string, $name as string, $credentials as object(), $default as boolean) as object()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>default</xqdoc:name><xqdoc:type>boolean</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>object()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>write-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Removes the specified credentials from the credential store.</p>
 <p>If no credentials with the given name and category are present
 in the category store an error is raised.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:remove-credentials("S3", "DataBucket");
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:return>The empty sequence.</xqdoc:return><xqdoc:error>credentials:NOT-EXIST if no credentials with the given name and category exist.</xqdoc:error><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the specified credentials and category name correspond with the default MongoDB credentials</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:remove-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function credentials:remove-credentials($category as string, $name as string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>write-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Makes the specified credentials the default for their category.</p>
 <p>It is not allowed to call this method on credentials in the "MongoDB" category.</p>
 <p>If the specified credentials are not present an error is raised.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:make-default("S3", "DataBucket");
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:return>The empty sequence.</xqdoc:return><xqdoc:error>credentials:NOT-EXIST if no credentials with the given name and category are present.</xqdoc:error><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the specified category is MongoDB</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:make-default</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function credentials:make-default($category as string, $name as string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>write-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="5"><xqdoc:comment><xqdoc:description> <p>Updates the specified credentials in the credential store.</p>
 <p>It is possible to specify whether the credentials should become or stop being the
 default credentials in their category, rename the credentials or change the credentials
 object. These three changes are specified by means of the $new-default, $new-name and
 $new-credentials parameter. If the corresponding parameter is the empty sequence the
 corresponding property will not be changed.</p>
 <p>For example the following query renames the "DataBucket" credentials in the "S3"
 category as "Bucket":
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:update-credentials("S3", "DataBucket", (), "Bucket", () );
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:param>$new-default Whether the credentials should become/stop being the default credentials in their category. If it is an empty sequence the current default property will not be changed.</xqdoc:param><xqdoc:param>$new-default The new credentials name. If it is an empty sequence the current name will not be changed.</xqdoc:param><xqdoc:param>$new-default The new credentials object. If it is an empty sequence the current credentials object will not be changed.</xqdoc:param><xqdoc:return>the empty sequence</xqdoc:return><xqdoc:error>credentials:NOT-EXIST if credentials with the given name and category do not exist.</xqdoc:error><xqdoc:error>credentials:EXIST if credentials with the given new name and category are already present.</xqdoc:error><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the specified credentials or category name correspond with the default MongoDB credentials</xqdoc:error><xqdoc:error>credentials:TEST if a connection cannot be established using the specified credentials</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:update-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function credentials:update-credentials($category as string, $name as string, $new-default as boolean?, $new-name as string?, $new-credentials as object()?) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>new-default</xqdoc:name><xqdoc:type occurrence="?">boolean</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>new-name</xqdoc:name><xqdoc:type occurrence="?">string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>new-credentials</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>write-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the given category's default credentials, if any.</p>
 <p>If no default credentials are present for the given category
 the empty sequence is returned.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:credentials("S3")
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The category name.</xqdoc:param><xqdoc:return>The specified category default credentials, if any.</xqdoc:return><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the specified category is MongoDB</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="strictlydeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:strictlydeterministic function credentials:credentials($category as string) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Returns the specified credentials, if present in the credential store.</p>
 <p>If the specified credentials are not present the empty sequence is returned.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:credentials("S3", "DataBucket")
 </pre>
 </p>
</xqdoc:description><xqdoc:param>$category The credentials category name.</xqdoc:param><xqdoc:param>$name The credentials name.</xqdoc:param><xqdoc:return>The specified credentials, if present.</xqdoc:return><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:MONGO-DEFAULT if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="strictlydeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:strictlydeterministic function credentials:credentials($category as string, $name as string) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-credentials-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Lists all the credentials in the credentials store.</p>
 <p>If no credentials are stored the empty sequence is returned.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:list-credentials()
 </pre>
 </p>
 <p>The returned array contains one object for each credential. Each object has
 the following structure:
 <pre>
 {
   "category": "category-name",
   "name": "credential-name",
   "default": true
 }
 </pre>
 Specifically the fields of each object have the following meaning:
 <ul>
  <li>category: the name of the credentials category (string)</li>
  <li>name: the name of the credentials (string)</li>
  <li>default: whether the credentials are the default credentials in
      their category (boolean)</li>
 </ul>
 </p>
</xqdoc:description><xqdoc:return>An array of all credentials in the credentials store.</xqdoc:return><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:list-credentials</xqdoc:name><xqdoc:signature>declare function credentials:list-credentials() as array()</xqdoc:signature><xqdoc:return><xqdoc:type>array()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>keys</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>project</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Lists all the credentials categories in the credentials store.</p>
 <p>If no credentials are stored the empty sequence is returned.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:list-categories()
 </pre>
 </p>
 <p>The returned array contains the name of each distinct credential category.</p>
</xqdoc:description><xqdoc:return>An array of all the distinct credentials categories in the credentials store.</xqdoc:return><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:list-categories</xqdoc:name><xqdoc:signature>declare function credentials:list-categories() as array()</xqdoc:signature><xqdoc:return><xqdoc:type>array()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>distinct-values</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Lists all the credentials of the specified category in the
 credentials store.</p>
 <p>If no credentials for the given category are stored the empty
 sequence is returned.</p>
 <p>Example:
 <pre>
 import module namespace credentials = "http://www.28msec.com/modules/credentials";
 credentials:list-category-credentials("category-name")
 </pre>
 </p>
 <p>The returned array contains one object for each credential. Each object has
 the following structure:
 <pre>
 {
   "category": "category-name",
   "name": "credential-name",
   "default": true
 }
 </pre>
 Specifically the fields of each object have the following meaning:
 <ul>
  <li>category: the name of the credentials category (string)</li>
  <li>name: the name of the credentials (string)</li>
  <li>default: whether the credentials are the default credentials in
      their category (boolean)</li>
 </ul>
 </p>
</xqdoc:description><xqdoc:param>$category-name The credentials category name.</xqdoc:param><xqdoc:return>An array of all the credentials of the specified category in the credentials store.</xqdoc:return><xqdoc:error>credentials:NAME if the credentials or category name is invalid</xqdoc:error><xqdoc:error>credentials:CREDENTIALS-STORE if an internal error arises accessing the crendentials store</xqdoc:error></xqdoc:comment><xqdoc:name>credentials:list-category-credentials</xqdoc:name><xqdoc:signature>declare function credentials:list-category-credentials($category-name as string) as array()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category-name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>array()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-category-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>keys</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>project</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:validate-category-name</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:validate-category-name($category-name as string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category-name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>matches</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string-length</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:validate-credentials-name</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:validate-credentials-name($credentials-name as string) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>credentials-name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>matches</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>string-length</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>credentials:mandatory-string-field</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:mandatory-string-field($object as object(), $field as string) as object()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>object</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>field</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>object()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>credentials:optional-string-field</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:optional-string-field($object as object(), $field as string) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>object</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>field</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>credentials:optional-boolean-field</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:optional-boolean-field($object as object(), $field as string) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>object</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>field</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:check-mongo-result</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:check-mongo-result($mongo-result as object()) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>mongo-result</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:name>credentials:validate-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function credentials:validate-credentials($category-name as string, $credentials as object()) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>category-name</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>validate-mongodb-credentials</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:validate-mongodb-credentials</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function credentials:validate-mongodb-credentials($credentials as object()) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>check-mongo-result</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>mandatory-string-field</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>optional-boolean-field</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>optional-string-field</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/mongodb</xqdoc:uri><xqdoc:name>connect</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/mongodb</xqdoc:uri><xqdoc:name>run-cmd</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>integer</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name-from-QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>members</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:name>credentials:read-credentials-file</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:read-credentials-file() as array()</xqdoc:signature><xqdoc:return><xqdoc:type>array()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>read-credentials-file-impl</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>parse-json</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:write-credentials-file</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function credentials:write-credentials-file($credentials as array()) as empty-sequence()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>array()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/credentials</xqdoc:uri><xqdoc:name>write-credentials-file-impl</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>serialize</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:name>credentials:read-credentials-file-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations><xqdoc:signature>declare %private function credentials:read-credentials-file-impl() as string external</xqdoc:signature><xqdoc:return><xqdoc:type>string</xqdoc:type></xqdoc:return></xqdoc:function><xqdoc:function arity="1"><xqdoc:name>credentials:write-credentials-file-impl</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="http://zorba.io/annotations" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function credentials:write-credentials-file-impl($credentials as string) as empty-sequence() external</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>credentials</xqdoc:name><xqdoc:type>string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>empty-sequence()</xqdoc:type></xqdoc:return></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>