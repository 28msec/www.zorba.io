<xqdoc:xqdoc xmlns:xqdoc="http://www.xqdoc.org/1.0"><xqdoc:control><xqdoc:date>2015-02-17T14:42:36.342765+02:00</xqdoc:date><xqdoc:version>1.0</xqdoc:version></xqdoc:control><xqdoc:module type="library"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>asynchronous-jobs</xqdoc:name><xqdoc:comment><xqdoc:description> <p>This module provides functionality for executing asynchronous jobs.
 There are three kinds of jobs: (1) a job for executing a (public or private)
 query of your project, (2) a job for mapping an input
 collection into an output collection, and (3) a job for shuffling the items
 of an input collection to several output collections.
 Map and Shuffle jobs are mostly used within
 the parallelism framework and are not meant to be created directly.</p>
 <p>Jobs that have been scheduled for execution can be referred to by
 an opaque identifier being returned by the corresponding scheduling
 function (e.g. job:execute or job:map). Specifically,
 the job's identifier can be used to retrieve the status of a job
 (e.g. job:status) or the names of its input and output collections.</p>
</xqdoc:description><xqdoc:author>Ghislain Fourny</xqdoc:author><xqdoc:author>Julien Ribon</xqdoc:author><xqdoc:author>Matthias Brantner</xqdoc:author><xqdoc:custom tag="language">xquery</xqdoc:custom><xqdoc:custom tag="version">3.0</xqdoc:custom><xqdoc:custom tag="encoding">utf-8</xqdoc:custom></xqdoc:comment><xqdoc:custom tag="namespaces"><xqdoc:namespace prefix="an" uri="" isSchema="false"/><xqdoc:namespace prefix="base64" uri="http://zorba.io/modules/base64" isSchema="false"/><xqdoc:namespace prefix="fetch" uri="http://zorba.io/modules/fetch" isSchema="false"/><xqdoc:namespace prefix="http-client" uri="http://www.zorba-xquery.com/modules/http-client" isSchema="false"/><xqdoc:namespace prefix="job" uri="http://www.28msec.com/modules/asynchronous-jobs" isSchema="false"/><xqdoc:namespace prefix="project" uri="http://www.28msec.com/modules/project" isSchema="false"/><xqdoc:namespace prefix="rand" uri="http://zorba.io/modules/random" isSchema="false"/><xqdoc:namespace prefix="request" uri="http://www.28msec.com/modules/http/request" isSchema="false"/><xqdoc:namespace prefix="store" uri="http://www.28msec.com/modules/store" isSchema="false"/></xqdoc:custom></xqdoc:module><xqdoc:imports><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/base64</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/fetch</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://zorba.io/modules/random</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://www.28msec.com/modules/http/request</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://www.28msec.com/modules/project</xqdoc:uri></xqdoc:import><xqdoc:import type="library"><xqdoc:uri>http://www.28msec.com/modules/store</xqdoc:uri></xqdoc:import></xqdoc:imports><xqdoc:variables><xqdoc:variable><xqdoc:uri>job:scheduler-uri</xqdoc:uri><xqdoc:comment><xqdoc:description> The URI of the scheduler, to push jobs to the queue.
</xqdoc:description><xqdoc:custom tag="type">xs:string</xqdoc:custom></xqdoc:comment><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/project</xqdoc:uri><xqdoc:name>scheduler-host</xqdoc:name></xqdoc:invoked><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable><xqdoc:variable><xqdoc:uri>job:max-send-count</xqdoc:uri><xqdoc:comment><xqdoc:description> The maximum number of times it is attempted to send a request
 to the scheduler.
</xqdoc:description><xqdoc:custom tag="type">xs:integer</xqdoc:custom></xqdoc:comment><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/></xqdoc:annotations></xqdoc:variable></xqdoc:variables><xqdoc:collections/><xqdoc:indexes/><xqdoc:functions><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Schedules an asynchronous job executing the given (public or private)
 query from your project.</p>
 <p>The result of the query will be stored in a collection withing the
 MongoDB database associated with the project. The name of the collection
 is randomly generated and starts with <tt>_28.temporary</tt>.</p>
</xqdoc:description><xqdoc:param>$query The path of the query to execute, which must begin with /public or /private. (examples: /public/query.xq, /private/query.jq).</xqdoc:param><xqdoc:return>The id of the scheduled job.</xqdoc:return><xqdoc:error>job:JBDY0003 if the supplied query path does not begin with /public or /private.</xqdoc:error><xqdoc:error>job:JBDY0004 if the supplied query path cannot be resolved.</xqdoc:error></xqdoc:comment><xqdoc:name>job:execute</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:execute($query as xs:string) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>query</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>execute</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Schedules an asynchronous job executing the given (public or private)
 query from your project.</p>
 <p>The $options parameter allows for the specification of properties for
 the asynchronously executed job. Allowed options are:
 <ul>
   <li><tt>output-collection as string</tt>: the name of the collection in
     which the output of the executed query is stored. If not specified,
     the result of the query will be stored in a collection withing the
     MongoDB database associated with the project. The name of the
     collection is randomly generated and starts with <tt>_28.temporary</tt>
   </li>
 </ul>
 </p>
</xqdoc:description><xqdoc:param>$query The path of the query to execute, which must begin with /public or /private. (examples: /public/query.xq, /private/query.jq).</xqdoc:param><xqdoc:param>$options An object specifying above options for the asynchronous job.</xqdoc:param><xqdoc:return>The id of the scheduled job.</xqdoc:return><xqdoc:error>err:XPTY0004 if the type of a supplied option is incorrect.</xqdoc:error><xqdoc:error>job:JBDY0003 if the supplied query path does not begin with /public or /private.</xqdoc:error><xqdoc:error>job:JBDY0004 if the supplied query path cannot be resolved.</xqdoc:error></xqdoc:comment><xqdoc:name>job:execute</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:execute($query as xs:string, $options as object()?) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>query</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>options</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>create-random-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>schedule</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/project</xqdoc:uri><xqdoc:name>name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/store</xqdoc:uri><xqdoc:name>flush</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>starts-with</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/fetch</xqdoc:uri><xqdoc:name>content</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Schedules an asynchronous job mapping the input collection
 to an output collection with the specified function.</p>
 <p>The name of the output collection is randomly generated and
 starts with <tt>_28.temporary</tt>.</p>
</xqdoc:description><xqdoc:param>$input-collection The name of the collection that the job processes.</xqdoc:param><xqdoc:param>$map-function The function which is run on the input collection's contents.</xqdoc:param><xqdoc:return>The id of the scheduled job, which can be used to pull for the status and results.</xqdoc:return><xqdoc:error>job:JBDY0005 if the supplied function does not have a name.</xqdoc:error><xqdoc:error>job:JBDY0006 if the supplied function is in the local namespace.</xqdoc:error><xqdoc:error>job:JBDY0008 if the supplied input collection does not exist.</xqdoc:error></xqdoc:comment><xqdoc:name>job:map</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:map($input-collection as xs:string, $map-function as function (item()*) as item()*) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input-collection</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>map-function</xqdoc:name><xqdoc:type>function (item()*) as item()*</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>map</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Schedules an asynchronous job mapping the input collection
 to an output collection with the specified function.</p>
 <p>The $options parameter allows for the specification of properties for
 the map job. Allowed options are:
 <ul>
   <li><tt>output-collection as string</tt>: the name of the collection in
     which the output of the executed query is stored. If not specified,
     the result of the query will be stored in a collection withing the
     MongoDB database associated with the project. The name of the
     collection is randomly generated and starts with <tt>_28.temporary</tt>
   </li>
   <li><tt>chunk-info as object</tt>: an object containing the specification of a chunk
     of the input collection. The mapping will only occur on this chunk.
     If not specified, the entire input collection will be mapped.
   </li>
   <li><tt>allow-streaming as boolean</tt>: a boolean indicating if calling the map function can
     be distributed over partitions of the input collection. If false, the map function will
     be called only once on the entire input collection. This might result
     in a cache overflow if the number of items is too big. If true,
     the input will be arbitrarily partitioned and the map function will be called for each
     partition. The size of a partition is chosen in order to be smaller than the cache size.
     The default is false.
   </li>
   <li><tt>dependencies as array</tt>: an array containing the ids of all asynchronous jobs that must
     be completed before this job starts. This job will be hold pending until all these dependencies
     are completed.
   </li>
 </ul>
 </p>
</xqdoc:description><xqdoc:param>$input-collection The name of the collection that the job processes.</xqdoc:param><xqdoc:param>$map-function The function which is run on the collection's contents.</xqdoc:param><xqdoc:param>$options An object specifying above options for the asynchronous job.</xqdoc:param><xqdoc:return>the id of the scheduled job, which can be used to pull for the status and results.</xqdoc:return><xqdoc:error>err:XPTY0004 if the type of a supplied option is incorrect.</xqdoc:error><xqdoc:error>job:JBDY0005 if the supplied function does not have a name.</xqdoc:error><xqdoc:error>job:JBDY0006 if the supplied function is in the local namespace.</xqdoc:error><xqdoc:error>job:JBDY0008 if the supplied input collection does not exist.</xqdoc:error></xqdoc:comment><xqdoc:name>job:map</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:map($input-collection as xs:string, $map-function as function (item()*) as item()*, $options as object()?) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input-collection</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>map-function</xqdoc:name><xqdoc:type>function (item()*) as item()*</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>options</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>build-map-shuffle</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>schedule</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:comment><xqdoc:description> <p>Schedules an asynchronous job shuffling the items of the input collections to output collections
 using the specified shuffle function.</p>
 <p>The $options parameter allows for the specification of properties for
 the shuffle job. Allowed options are:
 <ul>
   <li><tt>output-collections as array</tt>: an array with the names of the collections in
     which the items of the input collections are shuffled. Compulsory.
   </li>
   <li><tt>chunk-info as object</tt>: an object containing the specification of a chunk
     of the input collection. The shuffling will only occur on this chunk.
     If not specified, the entire input collection will be mapped.
   </li>
   <li><tt>dependencies as array</tt>: an array containing the ids of all asynchronous jobs that must
     be completed before this job starts. This job will be hold pending until all these dependencies
     are completed.
   </li>
 </ul>
 </p>
</xqdoc:description><xqdoc:param>$input-collection The name of the collection that the job processes.</xqdoc:param><xqdoc:param>$function The function which is run on each item to determine where it is shuffled to.</xqdoc:param><xqdoc:param>$options An object specifying above options for the asynchronous job.</xqdoc:param><xqdoc:return>the id of the scheduled job, which can be used to pull for the status and results.</xqdoc:return><xqdoc:error>err:XPTY0004 if the type of a supplied option is incorrect.</xqdoc:error><xqdoc:error>job:JBDY0005 if the supplied function does not have a name.</xqdoc:error><xqdoc:error>job:JBDY0006 if the supplied function is in the local namespace.</xqdoc:error><xqdoc:error>job:JBDY0008 if the supplied input collection does not exist.</xqdoc:error></xqdoc:comment><xqdoc:name>job:shuffle</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:shuffle($input-collection as xs:string, $shuffle-function as function (item()) as xs:integer, $options as object()?) as xs:string</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input-collection</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>shuffle-function</xqdoc:name><xqdoc:type>function (item()) as xs:integer</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>options</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="2"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>build-map-shuffle</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>schedule</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="2"><xqdoc:comment><xqdoc:description> <p>Builds an object describing an asynchronous job (map or shuffle).</p>
 <p>This object can then be sent to the scheduler.</p>
 <p>The $options parameter allows for the specification of properties for
 the shuffle job. Allowed options are:
 <ul>
   <li><tt>kind</tt>: the kind of job ("map" or "shuffle").</li>
   <li><tt>map-function</tt> (map jobs only): a function with any signature
   (item()* to item()*),
   and that is used to map the input collection to the output collection.</li>
   <li><tt>shuffle-function</tt> (shuffle jobs only): a function taking an item
   and returning an integer.
   It is used to select the output collection to which each item is sent.</li>
   <li><tt>output-collection as string</tt> (map jobs only): the name of the collection in
     which the output of the executed query is stored. If not specified,
     the result of the query will be stored in a collection withing the
     MongoDB database associated with the project. The name of the
     collection is randomly generated and starts with <tt>_28.temporary</tt>
   </li>
   <li><tt>output-collections as array</tt> (shuffle jobs only): an array with the names of the collections in
     which the items of the input collections are shuffled. Compulsory.
   </li>
   <li><tt>chunk-info as object</tt>: an object containing the specification of a chunk
     of the input collection. The shuffling will only occur on this chunk.
     If not specified, the entire input collection will be mapped.
   </li>
   <li><tt>allow-streaming as boolean</tt> (map jobs only): a boolean indicating if calling the map function can
     be distributed over partitions of the input collection. If false, the map function will
     be called only once on the entire input collection. This might result
     in a cache overflow if the number of items is too big. If true,
     the input will be arbitrarily partitioned and the map function will be called for each
     partition. The size of a partition is chosen in order to be smaller than the cache size.
     The default is false.
   </li>
   <li><tt>dependencies as array</tt>: an array containing the ids of all asynchronous jobs that must
     be completed before this job starts. This job will be hold pending until all these dependencies
     are completed.
   </li>
 </ul>
 </p>
</xqdoc:description><xqdoc:param>$input-collection The name of the collection that the job processes.</xqdoc:param><xqdoc:param>$options An object specifying above options for the asynchronous job.</xqdoc:param><xqdoc:return>the id of the scheduled job, which can be used to pull for the status and results.</xqdoc:return><xqdoc:error>err:XPTY0004 if the type of a supplied option is incorrect.</xqdoc:error><xqdoc:error>job:JBDY0005 if the supplied function does not have a name.</xqdoc:error><xqdoc:error>job:JBDY0006 if the supplied function is in the local namespace.</xqdoc:error><xqdoc:error>job:JBDY0008 if the supplied input collection is not available.</xqdoc:error></xqdoc:comment><xqdoc:name>job:build-map-shuffle</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:build-map-shuffle($input-collection as xs:string, $options as object()?) as object()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>input-collection</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>options</xqdoc:name><xqdoc:type occurrence="?">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>object()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>encode-for-roundtrip</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>create-random-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/project</xqdoc:uri><xqdoc:name>name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/store</xqdoc:uri><xqdoc:name>flush</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="4"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>concat</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>empty</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>exists</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>false</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>function-name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>local-name-from-QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>members</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>namespace-uri-from-QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>members</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:comment><xqdoc:description> <p>Returns the ids of all jobs created by this project.</p>
</xqdoc:description><xqdoc:return>the sequence of the ids of all jobs created so far.</xqdoc:return></xqdoc:comment><xqdoc:name>job:jobs</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:jobs() as object()*</xqdoc:signature><xqdoc:return><xqdoc:type occurrence="*">object()*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get-all</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the name of the input collection of a mapping asynchronous job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the name of the input collection of the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:input-collection</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:input-collection($id as xs:string) as xs:string?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">xs:string?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the kind of the asynchronous job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the kind of the asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:kind</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:kind($id as xs:string) as xs:string?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">xs:string?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the name of the map or shuffle function used by an asynchronous job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the name of the map or shuffle function of the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:function</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:function($id as xs:string) as xs:string?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">xs:string?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the name of the output collection of a mapping or executing asynchronous job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the name of the output collection of the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:output-collection</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:output-collection($id as xs:string) as xs:string?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">xs:string?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> Returns the name of the output collections of a shuffle asynchronous job.
</xqdoc:description><xqdoc:param>$uuid the UUID of the asynchronous job to query.</xqdoc:param><xqdoc:return>the name of the output collections of the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:output-collections</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:output-collections($id as xs:string) as xs:string*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">xs:string*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>members</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the name of the query executed by an executing asynchronous job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the name of the query executed by the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:query-name</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:query-name($id as xs:string) as xs:string?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">xs:string?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the error object output by an asynchronous job, in case of a failed job.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the error object output by the corresponding asynchronous job.</xqdoc:return></xqdoc:comment><xqdoc:name>job:error</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:error($id as xs:string) as object()?</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="?">object()?</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the properties of an asynchronous job as an object with the following
 fields:</p>
 <ul>
  <li><tt>accessed</tt>: the time at which the job was last accessed.</li>
  <li><tt>completed</tt>: the time at which the job was completed.</li>
  <li><tt>created</tt>: the time at which the job was created.</li>
  <li><tt>lock-acquired</tt>: the time at which a processing lock was taken on the job.</li>
  <li><tt>status</tt>: the status of the job. One of <tt>pending</tt>, <tt>in progress</tt>,
  <tt>completed</tt>, <tt>failed</tt>, <tt>timed out</tt>.</li>
  <li><tt>error</tt>: An object containing error information in case of failure.</li>
 </ul>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous job to query.</xqdoc:param><xqdoc:return>the time at which the corresponding asynchronous job was last accessed.</xqdoc:return></xqdoc:comment><xqdoc:name>job:properties</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:properties($id as xs:string) as object()</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type>object()</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>dateTime</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri></xqdoc:uri><xqdoc:name>null</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri></xqdoc:uri><xqdoc:name>project</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Returns the asynchronous job associated with the supplied asynchronous job id,
 or the asynchronous jobs associated with the supplied parallel job id.</p>
 <p>This function is internal and should only be used by the parallelism module.</p>
</xqdoc:description><xqdoc:param>$id the id of the asynchronous or parallel job to query.</xqdoc:param><xqdoc:return>the objects describing the asynchronous jobs.</xqdoc:return></xqdoc:comment><xqdoc:name>job:get</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:nondeterministic function job:get($id as xs:string) as object()*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>id</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">object()*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>integer</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>concat</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>serialize</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>parse-json</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="1"><xqdoc:comment><xqdoc:description> <p>Sends jobs to the job queue.</p>
 <p>This function is internal and should only be used by this and the parallelism module.</p>
</xqdoc:description><xqdoc:param>$jobs The job to send, as generated by job:build-map-shuffle().</xqdoc:param><xqdoc:return>Objects containing the new ids.</xqdoc:return></xqdoc:comment><xqdoc:name>job:schedule</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %an:sequential function job:schedule($jobs as object()*) as object()*</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>jobs</xqdoc:name><xqdoc:type occurrence="*">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:return><xqdoc:type occurrence="*">object()*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="3"><xqdoc:uri>http://www.28msec.com/modules/asynchronous-jobs</xqdoc:uri><xqdoc:name>send</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="3"><xqdoc:name>job:send</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function job:send($method as xs:string, $function as xs:string, $parameters as object()*)</xqdoc:signature><xqdoc:parameters><xqdoc:parameter><xqdoc:name>method</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>function</xqdoc:name><xqdoc:type>xs:string</xqdoc:type></xqdoc:parameter><xqdoc:parameter><xqdoc:name>parameters</xqdoc:name><xqdoc:type occurrence="*">object()</xqdoc:type></xqdoc:parameter></xqdoc:parameters><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>integer</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>concat</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>false</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>not</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>serialize</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>zero-or-one</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>delete</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>post</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>put</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>parse-json</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:name>job:get-all</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="" localname="nondeterministic" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:nondeterministic function job:get-all() as object()*</xqdoc:signature><xqdoc:return><xqdoc:type occurrence="*">object()*</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.28msec.com/modules/project</xqdoc:uri><xqdoc:name>name</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>QName</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2001/XMLSchema</xqdoc:uri><xqdoc:name>integer</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>concat</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="3"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>error</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>serialize</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://www.zorba-xquery.com/modules/http-client</xqdoc:uri><xqdoc:name>get</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri></xqdoc:uri><xqdoc:name>parse-json</xqdoc:name></xqdoc:invoked></xqdoc:function><xqdoc:function arity="0"><xqdoc:name>job:create-random-collection</xqdoc:name><xqdoc:annotations><xqdoc:annotation prefix="" namespace="http://www.w3.org/2005/xpath-functions" localname="private" value=""/><xqdoc:annotation prefix="an" namespace="" localname="sequential" value=""/></xqdoc:annotations><xqdoc:signature>declare %private %an:sequential function job:create-random-collection() as xs:string</xqdoc:signature><xqdoc:return><xqdoc:type>xs:string</xqdoc:type></xqdoc:return><xqdoc:invoked arity="0"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>current-date</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="2"><xqdoc:uri>http://www.w3.org/2005/xpath-functions</xqdoc:uri><xqdoc:name>format-date</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="0"><xqdoc:uri>http://zorba.io/modules/random</xqdoc:uri><xqdoc:name>uuid</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/static/collections/dml</xqdoc:uri><xqdoc:name>create</xqdoc:name></xqdoc:invoked><xqdoc:invoked arity="1"><xqdoc:uri>http://zorba.io/modules/store/static/collections/dml</xqdoc:uri><xqdoc:name>is-available-collection</xqdoc:name></xqdoc:invoked></xqdoc:function></xqdoc:functions></xqdoc:xqdoc>