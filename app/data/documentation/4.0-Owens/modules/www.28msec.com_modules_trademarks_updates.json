{ "ns" : "http://www.28msec.com/modules/trademarks/updates", "description" : " This module contains functions allowing to react to trademark updates.\n", "sees" : [  ], "authors" : [ "<xqdoc:author xmlns:xqdoc=\"http://www.xqdoc.org/1.0\">Alexander.Kreutz@28msec.com <h2>Usage example</h2> <p>Example code snippet:</p> <pre> variable $updates := updates:request-updates(\"myservice\", 10000, false()); try { if (exists($updates)) then { for $trademark in updates:trademarks($updates) return { ... // do something with the updated trademark } updates:confirm-updates($updates); } else () // Nothing to process } catch * { updates:mark-failed($updates); fn:error($err:code, $err:description, $err:value) } </pre> <p>This example code</p> <ul> <li>Requests a maximum of 10000 trademarks that have not yet been processed by this code snippet.</li> <li>It iterates over all updated trademarks and may do any action with each trademark. (for example generate some content)</li> <li>Afterwards it confirms the update so it gets newer updates the next time it is run.</li> <li>If an error occurs it marks the update as failed so it retrieves the same set of trademarks the next time it is run.</li> </ul></xqdoc:author>" ], "version" : null, "encoding" : "utf-8", "namespaces" : [ { "uri" : "", "prefix" : "an" }, { "uri" : "http://www.28msec.com/modules/mongodb", "prefix" : "mongo" }, { "uri" : "http://www.28msec.com/modules/trademarks", "prefix" : "trademarks" }, { "uri" : "http://www.28msec.com/modules/trademarks/updates", "prefix" : "updates" } ], "functions" : [ { "isDocumented" : true, "arity" : 1, "name" : "added-trademarks", "qname" : "updates:added-trademarks", "signature" : "($updates as object()) as object()*", "description" : " Return only trademarks contained in an trademark update chunk that have been added freshly to the database during that update.\n", "summary" : "<p> Return only trademarks contained in an trademark update chunk that have been added freshly to the database during that update.</p>", "annotation_str" : "", "annotations" : [  ], "updating" : false, "parameters" : [ { "name" : "updates", "type" : "object()", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> an update status object obtained from request-updates()</div>" } ], "returns" : { "type" : "object()*", "description" : "a sequence of trademarks that have been added to the database during the requested updates" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "confirm-updates", "qname" : "updates:confirm-updates", "signature" : "($update-obj as object()) as empty-sequence()", "description" : " Confirm that a chunk of trademark updates have been successfully processed.\n", "summary" : "<p> Confirm that a chunk of trademark updates have been successfully processed.</p>", "annotation_str" : " %an:sequential", "annotations" : [ { "prefix" : "an", "ns" : "", "name" : "sequential", "value" : "" } ], "updating" : false, "parameters" : [ { "name" : "update-obj", "type" : "object()", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> an update status object obtained using the request-updates function.</div>" } ], "returns" : { "type" : "empty-sequence()", "description" : "empty-sequence()" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "get-trademark-by-update-id", "qname" : "updates:get-trademark-by-update-id", "signature" : "($update-id as integer) as object()?", "description" : " Return the trademark for a given update number\n", "summary" : "<p> Return the trademark for a given update number\n</p>", "annotation_str" : "", "annotations" : [  ], "updating" : false, "parameters" : [ { "name" : "update-id", "type" : "integer", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> the update number of the trademark update</div>" } ], "returns" : { "type" : "object()?", "description" : "the trademark having that update number or empty sequence" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "mark-failed", "qname" : "updates:mark-failed", "signature" : "($update-obj as object()) as empty-sequence()", "description" : " Mark a trademark update chunk as failed so the updates may be requested again.\n", "summary" : "<p> Mark a trademark update chunk as failed so the updates may be requested again.</p>", "annotation_str" : " %an:sequential", "annotations" : [ { "prefix" : "an", "ns" : "", "name" : "sequential", "value" : "" } ], "updating" : false, "parameters" : [ { "name" : "update-obj", "type" : "object()", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> an update status object obtained using the request-updates function.</div>" } ], "returns" : { "type" : "empty-sequence()", "description" : "empty-sequence()" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "renamed-trademarks", "qname" : "updates:renamed-trademarks", "signature" : "($updates as object()) as object()*", "description" : " Return only trademarks contained in an trademark update chunk that have been renamed during that update.\n", "summary" : "<p> Return only trademarks contained in an trademark update chunk that have been renamed during that update.</p>", "annotation_str" : "", "annotations" : [  ], "updating" : false, "parameters" : [ { "name" : "updates", "type" : "object()", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> an update status object obtained from request-updates()</div>" } ], "returns" : { "type" : "object()*", "description" : "a sequence of trademarks that have been renamed with an additional key \"old-mark-identification\" with the old trademark name as value." }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 3, "name" : "request-updates", "qname" : "updates:request-updates", "signature" : "($service-name as string, $limit as integer, $allow-parallelization as boolean) as object()?", "description" : " Request a chunk of unprocessed trademark updates.\n", "summary" : "<p> Request a chunk of unprocessed trademark updates.</p>", "annotation_str" : " %an:sequential", "annotations" : [ { "prefix" : "an", "ns" : "", "name" : "sequential", "value" : "" } ], "updating" : false, "parameters" : [ { "name" : "service-name", "type" : "string", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> a project unique name for what you want to do with the updates. (like generate-sitemap)</div>" }, { "name" : "limit", "type" : "integer", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> the maximum number of trademark updates you want to process now.</div>" }, { "name" : "allow-parallelization", "type" : "boolean", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> set to true if what you want to do with the updates may be done in parralel using multiple instances. Using false will block later calls to request-updates for the given service-name until the returned updates have been confirmed or marked as failed.</div>" } ], "returns" : { "type" : "object()?", "description" : "an update status object that may be passed to the other functions of this library" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "reset-to-beginning", "qname" : "updates:reset-to-beginning", "signature" : "($service-name as string) as empty-sequence()", "description" : " Reset trademark updates for a service name so that all updates may be processed again by this service.\n", "summary" : "<p> Reset trademark updates for a service name so that all updates may be processed again by this service.</p>", "annotation_str" : " %an:sequential", "annotations" : [ { "prefix" : "an", "ns" : "", "name" : "sequential", "value" : "" } ], "updating" : false, "parameters" : [ { "name" : "service-name", "type" : "string", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> a project unique name used with the request-updates function. After reset-to-beginning has been called request-updates will return all updates again for this service-name.</div>" } ], "returns" : { "type" : "empty-sequence()", "description" : "empty-sequence()" }, "errors" : [  ] }, { "isDocumented" : true, "arity" : 1, "name" : "trademarks", "qname" : "updates:trademarks", "signature" : "($updates as object()) as object()*", "description" : " Return trademarks contained in an trademark update chunk.\n", "summary" : "<p> Return trademarks contained in an trademark update chunk.</p>", "annotation_str" : "", "annotations" : [  ], "updating" : false, "parameters" : [ { "name" : "updates", "type" : "object()", "occurrence" : null, "description" : "<div xmlns:xqdoc=\"http://www.xqdoc.org/1.0\"> an update status object obtained from request-updates()</div>" } ], "returns" : { "type" : "object()*", "description" : "a sequence of trademarks that have been updated" }, "errors" : [  ] } ], "variables" : [  ] }